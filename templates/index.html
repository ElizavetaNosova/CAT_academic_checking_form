<!doctype html>
<html>
  <head>
	<link rel='shortcut icon' type='image/x-icon' href="{{url_for('static', filename='images/favicon.ico') }}" />
    <title>Проверьте ваш академический текст</title>
  </head>
  <body>

     <div id='upload_instruction'>
        Загрузите txt-файл в кодировке utf-8
     </div>
     <form id="docx-form" method="post">
		<input accept='.txt, .docx' id="docx-file" type="file" name="file">
	</form>
	 
	<script type=text/javascript src="{{url_for('static', filename='jquery-3.5.1.min.js') }}"></script> 

	<script type=text/javascript src="{{url_for('static', filename='jquery.form.min.js') }}"></script> 

   <!-- <iframe src="http://localhost:5000/uploads/student_text.txt" id="docx_frame" height="1000" width="1000"></iframe> -->
	<script>


	$('#docx-file').change(function() {
		$('#docx-form').ajaxSubmit({
			method: 'post',
			type: 'post',
			url: '/upload_file',
			success: function(data) {
				// После загрузки файла очистим форму.
				console.log(data);
				window.location.replace(encodeURI("/spelling_form?file_id=" + data.file_id));
			},
            error: function(error){
                console.log(error);
                $('#upload_instruction').text(`${error.responseText}. Исправьте и повторите попытку`);
            }
		// }).done(function(data) {
		// 		// После загрузки файла очистим форму.
		// 		console.log(data);
		// 		//window.location.replace(encodeURI("/spelling_form?file_id=" + data.file_id));
	 	});
	});
	</script>
</body>
</html>